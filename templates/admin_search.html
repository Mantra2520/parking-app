<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Admin Search</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='nav.css') }}" />
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            margin: 0;
            padding-top: 90px;
            background-color: #f8f9fa;
            font-family: 'Segoe UI', sans-serif;
            padding-bottom: 20px;
        }

        form {
            width: 80%;
            max-width: 600px;
            margin: 20px auto;
            background-color: white;
            padding: 20px 24px;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }


        .input-container {
            width: 100%;
            display: flex;
            background: white;
            border-radius: 1rem;
            background: linear-gradient(45deg, #c5c5c5 0%, #ffffff 100%);
            padding: 0.3rem;
            gap: 0.3rem;
        }

        .input-container input[type="text"] {
            height: 5px;
            border-radius: 0;
            background: #e8e8e8;
            padding: 1rem;
            border: none;
            color: #5e5e5e;
            flex: 1;
            min-width: 150px;
        }

        .input-container input:focus {
            outline: none;
            box-shadow: inset 13px 13px 10px #BFF0FA, inset -13px -13px 10px #f4f4f4;
        }

        .input-container button[type="submit"] {
            padding: 0px 12px 0px 12px;
            height: 37px;
            background: linear-gradient(135deg, #4facfe, #00f2fe);
            font-weight: 900;
            color: white;
            border: none;
            border-radius: 0 1rem 1rem 0;
            cursor: pointer;
        }

        h3 {
            font-size: 20px;
            font-weight: 800;
            text-align: center;
            margin-top: 20px;
            width: fit-content;
            margin-left: auto;
            margin-right: auto;
            margin-bottom: 40px;
            letter-spacing: 1px;
        }

        .input-container button[type="submit"]:hover {
            background: linear-gradient(135deg, #4fb6ff, #28f8ff)
        }

        .paste-button {
            position: relative;
        }

        .paste-button .button {
            height: 37px;
            background: linear-gradient(135deg, #4facfe, #00f2fe);
            color: #ffffff;
            padding: 9px 14px;
            font-size: 14px;
            font-weight: 900;
            border: none;
            border-radius: 12px 0 0 12px;
            cursor: pointer;
            width: 120px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            text-align: left;
        }


        .dropdown-content {
            display: none;
            font-size: 13px;
            position: absolute;
            z-index: 1;
            min-width: 240px;
            background-color: #212121;
            border: 2px solid #4facfe;
            border-radius: 0 15px 15px 15px;
            box-shadow: 0px 8px 16px rgba(0, 0, 0, 0.2);
            top: 100%;
            left: 0;
        }

        .dropdown-content a {
            color: #4facfe;
            padding: 10px 15px;
            text-decoration: none;
            display: block;
        }

        .dropdown-content a:hover {
            background: linear-gradient(135deg, #4facfe, #00f2fe);
            color: #212121;
        }

        .dropdown-content a:first-child:hover {
            border-radius: 0px 13px 0px 0px;
        }

        .dropdown-content a:last-child:hover {
            border-radius: 0px 0px 13px 13px;
        }

        .paste-button:hover .dropdown-content {
            display: block;
        }

        .search-box h1 {
            font-size: 32px;
            font-weight: 800;
            text-align: center;
            color: #2c3e50;
            margin-top: 30px;
            width: fit-content;
            margin-left: auto;
            margin-right: auto;
            margin-bottom: 40px;
            letter-spacing: 1px;
        }


        table {
            width: 90%;
            margin: auto;
            border-collapse: collapse;
            background-color: #ffffff;
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            border-radius: 10px;
        }

        table th,
        table td {
            padding: 12px 15px;
            text-align: center;
            border-bottom: 1px solid #ddd;
        }

        table th {
            color: white;
            text-transform: uppercase;
            font-size: 16px;
        }

        table tr:first-child {
            background: linear-gradient(135deg, #4facfe, #00f2fe);
        }

        table tr:hover {
            background-color: #f1f1f1;
        }

        table tr:last-child td {
            border-bottom: none;
        }

        h2 {
            text-align: center;
            margin-bottom: 20px;
            color: #2c3e50;

        }
    </style>
</head>

<body>
    <nav>
        <span>Welcome Admin</span>
        <a href="{{ url_for('admin_bp.admin_home') }}">Home</a>
        <a href="{{ url_for('admin_userdata_bp.admin_userdata') }}">Users</a>
        <a href="{{ url_for('admin_search_bp.admin_search') }}">Search</a>
        <a href="{{ url_for('admin_summary_bp.admin_summary') }}">Summary</a>
        <a href="{{ url_for('login_bp.logout') }}">Logout</a>
    </nav>

    <div class="search-box">
        <form method="post">
            <h1>Search</h1>
            <div class="input-container">
                <div class="paste-button">
                    <button type="button" class="button" id="filterButton">Filter ▼</button>
                    <div class="dropdown-content">
                        <a href="#" onclick="setSearchOption('user_id')">User by ID</a>
                        <a href="#" onclick="setSearchOption('user_name')">User by Name</a>
                        <a href="#" onclick="setSearchOption('parkinglot__primelocation')">Parking Lot by Prime
                            Location</a>
                        <a href="#" onclick="setSearchOption('parkinglot__id')">Parking Lot by Lot ID</a>
                        <a href="#" onclick="setSearchOption('parkingspot_id')">Parking Spot by Spot ID</a>
                        <a href="#" onclick="setSearchOption('reservation_id')">Reservation by Reservation ID</a>
                        <a href="#" onclick="setSearchOption('reservation_userid')">Reservation by User ID</a>
                        <a href="#" onclick="setSearchOption('reservation_vno')">Reservation by Vehicle No.</a>
                    </div>
                </div>

                <input type="hidden" name="search_option" id="search_option">

                <input name="search" placeholder="Enter value..." type="text" required>

                <button type="submit">SEARCH</button>
            </div>

        </form>
    </div>


    {% if k == 1 %}
    <h3>No Result</h3>
    {% else %}

    {% if user %}
    <h2>User Details</h2>
    <table>
        <tr>
            <th>User ID</th>
            <th>Name</th>
            <th>Email</th>
            <th>Address</th>
            <th>Pincode</th>
        </tr>
        <tr>
            <td>{{ user.userid }}</td>
            <td>{{ user.fullname }}</td>
            <td>{{ user.email }}</td>
            <td>{{ user.Address }}</td>
            <td>{{ user.pincode }}</td>
        </tr>
    </table>
    {% endif %}

    {% if lot %}
    <h2>Parking Lot Details</h2>
    <table>
        <tr>
            <th>Lot ID</th>
            <th>Location</th>
            <th>Address</th>
            <th>Pincode</th>
            <th>Price</th>
            <th>Max Spots</th>
        </tr>
        <tr>
            <td>{{ lot.lot_id }}</td>
            <td>{{ lot.prime_location_name }}</td>
            <td>{{ lot.address }}</td>
            <td>{{ lot.pin_code }}</td>
            <td>{{ lot.price }}</td>
            <td>{{ lot.max_spots }}</td>
        </tr>
    </table>
    {% endif %}

    {% if spot %}
    <h2>Parking Spot</h2>
    <table>
        <tr>
            <th>Spot ID</th>
            <th>Lot ID</th>
            <th>Status</th>
        </tr>
        <tr>
            <td>{{ spot.spot_id }}</td>
            <td>{{ spot.lot_id }}</td>
            <td>{{ "Available" if spot.status == "A" else "Occupied" }}</td>
        </tr>
    </table>
    {% endif %}

    {% if res %}
    <h2>Reservation Details</h2>
    <table>
        <tr>
            <th>Reservation ID</th>
            <th>User ID</th>
            <th>Spot ID</th>
            <th>Vehicle No</th>
            <th>Entry Date</th>
            <th>Exit Date</th>
            <th>In Time</th>
            <th>Out Time</th>
            <th>Cost</th>
        </tr>
        {% for r in res %}
        <tr>
            <td>{{ r.res_id }}</td>
            <td>{{ r.user_id }}</td>
            <td>{{ r.spot_id }}</td>
            <td>{{ r.vehicle_no }}</td>
            <td>{{ r.in_date.strftime('%Y-%m-%d') if r.in_date else "N/A" }}</td>
            <td>{{ r.out_date.strftime('%Y-%m-%d') if r.out_date else "N/A" }}</td>
            <td>{{ r.in_time.strftime('%H:%M') if r.in_time else "N/A" }}</td>
            <td>{{ r.out_time.strftime('%H:%M') if r.out_time else "N/A" }}</td>
            <td>{{ r.cost_unit_time }}</td>
        </tr>
        {% endfor %}
    </table>
    {% endif %}
    {% endif %}




    <script>
        function setSearchOption(option) {
            document.getElementById('search_option').value = option;
        }
    </script>

    <script>
        function setSearchOption(value) {
            document.getElementById("search_option").value = value;

            const labels = {
                user_id: "User by ID",
                user_name: "User by Name",
                parkinglot__primelocation: "Parking Lot by Prime Location",
                parkinglot__id: "Parking Lot by Lot ID",
                parkingspot_id: "Parking Spot by Spot ID",
                reservation_id: "Reservation by Reservation ID",
                reservation_userid: "Reservation by User ID",
                reservation_vno: "Reservation by Vehicle No."
            };

            document.getElementById("filterButton").innerHTML = labels[value] + " ▼";
        }
    </script>


</body>

</html>